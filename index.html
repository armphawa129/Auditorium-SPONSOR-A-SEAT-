<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Auditorium - Public View (Full Access Zoom)</title>
    <style>
        :root { --gold: #ffd700; --dark-gold: #b8860b; --bg-dark: #0f172a; --seat-blue: #1e40af; --stair-step: rgba(255, 255, 255, 0.05); --danger: #ef4444; --highlight: #22c55e; }
        
        body { 
            background-color: var(--bg-dark); 
            color: white; 
            font-family: 'Segoe UI', Arial, sans-serif; 
            margin: 0; 
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.85); display: none; justify-content: center; align-items: center; z-index: 5000; font-weight: bold; color: var(--gold); }
        
        /* ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏±‡∏ß‡∏´‡∏∏‡πâ‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏•‡∏≤‡∏î‡∏Ç‡∏∂‡πâ‡∏ô */
        .scroll-wrapper {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            display: block; /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å flex ‡πÄ‡∏õ‡πá‡∏ô block ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ margin auto ‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á */
            text-align: center; /* ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏° */
        }

        .search-container { margin: 0 auto 30px auto; position: sticky; left: 0; top: 0; z-index: 1000; width: 90%; max-width: 400px; }
        #seatSearch { width: 100%; padding: 12px 20px; border-radius: 50px; border: 2px solid var(--gold); background: rgba(30, 41, 59, 0.9); color: white; font-size: 16px; outline: none; box-shadow: 0 0 20px rgba(255, 215, 0, 0.2); backdrop-filter: blur(10px); }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Cinema Container ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏∏‡∏î */
        .cinema-container { 
            display: inline-flex;
            flex-direction: column-reverse; 
            align-items: center; 
            gap: 10px; 
            padding: 40px 60px;
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%); 
            position: relative; 
            min-width: 800px;
            margin: 0 auto; /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏° ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏à‡∏∞‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ */
            text-align: left;
        }

        /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î */
        @media (max-width: 850px) {
            .scroll-wrapper {
                text-align: left; 
            }
            .cinema-container {
                margin: 0; 
                padding-left: 20px; /* ‡∏•‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            }
        }

        .zone { display: flex; flex-direction: column; gap: 8px; margin-bottom: 50px; position: relative; }
        .row { display: flex; align-items: center; justify-content: center; position: relative; }
        .row-label { width: 45px; font-weight: bold; text-align: center; color: #64748b; font-size: 13px; }
        .block { display: flex; gap: 3px; }
        .aisle-stairs { width: 35px; height: 20px; margin: 0 12px; background: linear-gradient(to bottom, transparent 50%, var(--stair-step) 50%); background-size: 100% 4px; opacity: 0.7; }
        .block-center { display: flex; gap: 3px; width: 335px; justify-content: center; }
        .stairs-center { width: 126px; height: 18px; background: linear-gradient(to bottom, transparent 50%, rgba(255,255,255,0.08) 50%); background-size: 100% 4px; border-left: 1px solid #475569; border-right: 1px solid #475569; display: flex; align-items: center; justify-content: center; }
        .stairs-center::after { content: "stairs"; font-size: 8px; color: #475569; text-transform: uppercase; }
        .control-desk-box { position: absolute; width: 335px; height: 44px; background: #1e293b; border: 2px solid var(--gold); border-radius: 4px; z-index: 100; top: -2px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; color: var(--gold); letter-spacing: 1px; }
        
        .seat { width: 18px; height: 18px; background-color: var(--seat-blue); color: white; font-size: 8px; display: flex; align-items: center; justify-content: center; border-radius: 3px 3px 1px 1px; cursor: pointer; transition: 0.3s; border: 1px solid rgba(255,255,255,0.1); }
        .seat.booked { background: linear-gradient(145deg, var(--gold), var(--dark-gold)); color: #5c4033; font-weight: bold; }
        .seat.search-match { transform: scale(1.8); z-index: 100; box-shadow: 0 0 15px var(--highlight); border: 2px solid var(--highlight); }
        .stage { width: 650px; height: 50px; background: linear-gradient(to top, #475569, #1e293b); border-radius: 100px 100px 0 0; display: flex; align-items: center; justify-content: center; font-weight: bold; letter-spacing: 10px; margin-bottom: 60px; border-top: 2px solid #94a3b8; }
        .status-bar { position: fixed; bottom: 20px; background: rgba(15, 23, 42, 0.95); padding: 10px 30px; border: 2px solid var(--gold); border-radius: 50px; z-index: 2000; font-weight: bold; font-size: 14px; left: 50%; transform: translateX(-50%); white-space: nowrap; }
    </style>
</head>
<body>
    <div id="loader">REFRESHING DATA...</div>
    
    <div class="search-container">
        <input type="text" id="seatSearch" placeholder="üîç Search owner name..." oninput="handleSearch()">
    </div>

    <div class="scroll-wrapper">
        <div class="cinema-container">
            <div class="stage">STAGE</div>
            <div id="lowerZone" class="zone"></div>
            <div id="midZone" class="zone"></div>
            <div id="upperZone" class="zone"></div>
        </div>
    </div>

    <div class="status-bar">Booked: <span id="bookedCount">0</span> / 720 Seats</div>

    <script>
        const isAdmin = false; 
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbw2S3YOLRDAP7O_9B-MU4NRk79_mXyd2pnLCShbEauRAE1nPYO2wfy7qIJM1ptITxQu/exec";
        
        const plans = {
            lower: [{ r: 'H', l: 11, c: 16, ri: 11 }, { r: 'G', l: 11, c: 15, ri: 11 }, { r: 'F', l: 10, c: 16, ri: 10 }, { r: 'E', l: 10, c: 15, ri: 10 }, { r: 'D', l: 9,  c: 16, ri: 9 },  { r: 'C', l: 9,  c: 15, ri: 9 }, { r: 'B', l: 8,  c: 16, ri: 8 },  { r: 'A', l: 6,  c: 15, ri: 6 }],
            mid: [{ r: 'M', l: 14, c: 16, ri: 14 }, { r: 'L', l: 14, c: 15, ri: 14 }, { r: 'K', l: 13, c: 16, ri: 13 }, { r: 'J', l: 13, c: 15, ri: 13 }],
            upper: [{ r: 'U', l: 16, c: 0, ri: 16, hasControl: true }, { r: 'T', l: 16, c: 0, ri: 16 }, { r: 'S', l: 16, c: 16, ri: 16 }, { r: 'R', l: 16, c: "stairs", ri: 16 }, { r: 'Q', l: 16, c: "stairs", ri: 16 }, { r: 'P', l: 16, c: "stairs", ri: 16 }, { r: 'N', l: 15, c: "stairs", ri: 15 }]
        };

        function renderZone(zoneId, data) {
            const container = document.getElementById(zoneId);
            data.forEach(item => {
                const rowDiv = document.createElement('div'); rowDiv.className = 'row';
                rowDiv.appendChild(createLabel(item.r));
                const leftBlock = document.createElement('div'); leftBlock.className = 'block';
                let leftStartNum = 16 - (item.l - 1);
                for (let i = 0; i < item.l; i++) createSeat(leftBlock, item.r, leftStartNum + i);
                rowDiv.appendChild(leftBlock);
                rowDiv.appendChild(Object.assign(document.createElement('div'), {className:'aisle-stairs'}));
                const midBlock = document.createElement('div'); midBlock.className = 'block-center';
                if (item.c === "stairs") {
                    for(let i=17; i<=21; i++) createSeat(midBlock, item.r, i);
                    midBlock.appendChild(Object.assign(document.createElement('div'), {className:'stairs-center'}));
                    for(let i=28; i<=32; i++) createSeat(midBlock, item.r, i);
                } else if (item.c === 0) {
                    if (item.hasControl) {
                        const desk = document.createElement('div'); desk.className = 'control-desk-box'; desk.innerText = "CONTROL";
                        midBlock.appendChild(desk);
                    }
                } else {
                    for (let i = 0; i < item.c; i++) createSeat(midBlock, item.r, 17 + i);
                }
                rowDiv.appendChild(midBlock);
                rowDiv.appendChild(Object.assign(document.createElement('div'), {className:'aisle-stairs'}));
                const rightBlock = document.createElement('div'); rightBlock.className = 'block';
                for (let i = 0; i < item.ri; i++) createSeat(rightBlock, item.r, 33 + i);
                rowDiv.appendChild(rightBlock);
                rowDiv.appendChild(createLabel(item.r));
                container.appendChild(rowDiv);
            });
        }

        function createSeat(parent, rowName, seatNumber) {
            const seatId = `${rowName}-${seatNumber}`;
            const seat = document.createElement('div');
            seat.className = 'seat'; seat.id = seatId; seat.innerText = seatNumber;
            seat.dataset.originalNo = seatNumber;
            
            seat.onclick = () => { 
                const seatName = `Row ${rowName} - Seat ${seatNumber}`;
                if (seat.classList.contains('booked')) {
                    alert(`${seatName}\n------------------\nStatus: Booked\nOwner: ${seat.dataset.displayName}`);
                } else {
                    alert(`${seatName}\n------------------\nStatus: Available\nPlease contact our staff to reserve this seat.`);
                }
            };
            parent.appendChild(seat);
        }

        async function fetchBookings() {
            try {
                const res = await fetch(WEB_APP_URL);
                const data = await res.json();
                document.querySelectorAll('.seat').forEach(s => {
                    const saved = data[s.id];
                    if (saved) {
                        s.dataset.displayName = saved.disp;
                        s.classList.add('booked'); 
                        s.innerText = '‚òÖ';
                        s.title = "Owner: " + saved.disp;
                    } else {
                        s.classList.remove('booked'); 
                        s.innerText = s.dataset.originalNo;
                        s.removeAttribute('title');
                        s.dataset.displayName = "";
                    }
                });
                document.getElementById('bookedCount').innerText = document.querySelectorAll('.seat.booked').length;
            } catch(e) { console.error(e); }
        }

        function handleSearch() {
            const query = document.getElementById('seatSearch').value.toLowerCase().trim();
            document.querySelectorAll('.seat').forEach(seat => {
                seat.classList.remove('search-match');
                if (query !== "") {
                    const disp = (seat.dataset.displayName || "").toLowerCase();
                    if (disp.includes(query)) seat.classList.add('search-match');
                }
            });
        }

        function createLabel(text) { const el = document.createElement('div'); el.className = 'row-label'; el.innerText = text; return el; }

        renderZone('lowerZone', plans.lower);
        renderZone('midZone', plans.mid);
        renderZone('upperZone', plans.upper);
        
        document.getElementById('loader').style.display = 'flex';
        fetchBookings().then(() => { document.getElementById('loader').style.display = 'none'; });
        setInterval(fetchBookings, 10000);
    </script>
</body>
</html>
